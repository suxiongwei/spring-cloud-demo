{
  "comment": "企业级 Sentinel 限流策略配置示例，此配置文件包含各种限流规则，可以直接导入到 Nacos 中使用",
  
  "flow-rules": [
    {
      "comment": "秒杀接口限流规则 - QPS限制为1",
      "resource": "seckill-order",
      "limitApp": "default",
      "grade": 1,
      "count": 1,
      "strategy": 0,
      "controlBehavior": 0,
      "clusterMode": false
    },
    {
      "comment": "关联限流规则 - 当write-db并发超过1时，限流read-db",
      "resource": "read-db",
      "limitApp": "default",
      "grade": 0,
      "count": 1,
      "strategy": 1,
      "refResource": "write-db",
      "controlBehavior": 0,
      "clusterMode": false
    },
    {
      "comment": "QPS限流示例 - 每秒最多10个请求",
      "resource": "rateLimit-qps",
      "limitApp": "default",
      "grade": 1,
      "count": 10,
      "strategy": 0,
      "controlBehavior": 0,
      "clusterMode": false
    },
    {
      "comment": "并发线程数限流示例 - 最多同时处理5个请求",
      "resource": "rateLimit-thread",
      "limitApp": "default",
      "grade": 0,
      "count": 5,
      "strategy": 0,
      "controlBehavior": 0,
      "clusterMode": false
    },
    {
      "comment": "链路限流示例 - 默认链路每秒最多20个请求",
      "resource": "common-resource",
      "limitApp": "default",
      "grade": 1,
      "count": 20,
      "strategy": 0,
      "controlBehavior": 0,
      "clusterMode": false
    },
    {
      "comment": "链路限流示例 - 链路A每秒最多10个请求",
      "resource": "common-resource",
      "limitApp": "chain-A",
      "grade": 1,
      "count": 10,
      "strategy": 0,
      "controlBehavior": 0,
      "clusterMode": false
    }
  ],
  
  "param-flow-rules": [
    {
      "comment": "热点参数限流示例 - 基于第一个参数(userId)进行限流，普通用户每秒最多5次请求",
      "resource": "hotspot-param",
      "limitApp": "default",
      "grade": 1,
      "count": 5,
      "strategy": 0,
      "controlBehavior": 0,
      "paramIdx": 0,
      "paramFlowItemList": [
        {
          "comment": "特殊用户限流配置 - userId为1001的用户每秒最多2次请求",
          "object": "1001",
          "classType": "java.lang.Long",
          "count": 2
        }
      ]
    }
  ],
  
  "degrade-rules": [
    {
      "comment": "慢调用比例熔断 - 10秒内慢调用比例超过60%时熔断10秒",
      "resource": "degrade-rt",
      "grade": 0,
      "count": 1000,
      "timeWindow": 10,
      "minRequestAmount": 5,
      "statIntervalMs": 10000,
      "slowRatioThreshold": 0.6
    }
  ],
  
  "system-rules": [
    {
      "comment": "系统自适应保护 - 系统负载超过2.0或CPU使用率超过80%时触发保护",
      "highestSystemLoad": 2.0,
      "qps": -1,
      "avgRt": -1,
      "maxThread": -1,
      "highestCpuUsage": 0.8
    }
  ],
  
  "authority-rules": [
    {
      "comment": "白名单控制 - 只允许白名单应用访问",
      "resource": "authority-control",
      "limitApp": "white_list",
      "strategy": 0
    },
    {
      "comment": "黑名单控制 - 拒绝黑名单应用访问",
      "resource": "authority-control",
      "limitApp": "black_list",
      "strategy": 1
    }
  ]
}