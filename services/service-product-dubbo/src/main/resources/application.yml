server:
  port: 8011

logging:
  charset:
    console: UTF-8

spring:
  profiles:
    active: local
#   active: local,shanghai
  #  active: local,beijing
  application:
    name: service-product-dubbo
  cloud:
    nacos:
      # 配置 Nacos 地址
      server-addr: ${NACOS_SERVER_ADDR:127.0.0.1:8848}
      username: ${NACOS_USERNAME:nacos}
      password: ${NACOS_PASSWORD:nacos}
      discovery:
        namespace: ${NACOS_NAMESPACE:public}
        enabled: true
        username: ${NACOS_USERNAME:nacos}
        password: ${NACOS_PASSWORD:nacos}
      config:
        namespace: ${NACOS_NAMESPACE:public}
        username: ${NACOS_USERNAME:nacos}
        password: ${NACOS_PASSWORD:nacos}
        import-check:
          enabled: true

# Dubbo 配置
dubbo:
  application:
    name: service-product-dubbo
    # QOS 配置
    qos-enable: true
    qos-port: 22222
  # 配置中心（用于动态配置规则）
  config-center:
    address: nacos://${NACOS_SERVER_ADDR:127.0.0.1:8848}
    username: ${NACOS_USERNAME:nacos}
    password: ${NACOS_PASSWORD:nacos}
    parameters:
      namespace: ${NACOS_NAMESPACE:public}
    group: dubbo
    timeout: 3000
    # 注意：这里不需要配置 config-file，动态配置规则会自动监听 *.configurators
    # config-file: dubbo.properties  # 可选，仅用于应用启动时的静态全局配置
  registry:
    address: nacos://${NACOS_SERVER_ADDR:127.0.0.1:8848}
    username: ${NACOS_USERNAME:nacos}
    password: ${NACOS_PASSWORD:nacos}
    parameters:
      namespace: ${NACOS_NAMESPACE:public}
      prefer-ip-address: true
#      region: hangzhou
  # 协议配置
  protocols:
    dubbo:
      name: dubbo
      port: 20881
    tri:
      name: tri
      port: 50051
  # 服务暴露配置
  provider:
    # 负载均衡权重（默认100）
    weight: 100
    # 调用超时（窗口时间），单位：ms
    timeout: 3000
    # 失败重试次数
    retries: 1
    # 最大欢迎选抩数（failover模式）
    loadbalance: random
    # 需要管理的线程数
    threads: 200
    # 线程池队列次数（积压池）
    queues: 0
    # 集群模式：failover、failfast、failsafe、failback、forking，默认为failover
    cluster: failover

---
spring:
  config:
    import:
      - nacos:common.yaml?group=product
    activate:
      on-profile: local

---
spring:
  config:
    import:
      - nacos:common.yaml?group=product
    activate:
      on-profile: beijing
server:
  port: 8012
dubbo:
  application:
    qos-port: 22223
  registry:
    # 用于业务逻辑显示（在代码中获取区域名称）和服务元数据注册
    parameters:
      region: beijing
  provider:
    # 权重配置：北京节点权重较高
#    tag: beijing
    weight: 150
  protocols:
    dubbo:
      port: 20882
    tri:
      port: 50052

---
spring:
  config:
    import:
      - nacos:common.yaml?group=product
    activate:
      on-profile: shanghai
server:
  port: 8013
dubbo:
  application:
    qos-port: 22224
  registry:
    parameters:
      region: shanghai
  provider:
    # 权重配置：上海节点权重较低
    weight: 50
  protocols:
    dubbo:
      port: 20883
    tri:
      port: 50053



